import{A as T}from"./AuthenticatedLayout-Csk7A1cc.js";import{r as s,C as O,D as P,o as H,e as c,b as m,c as b,d as o,u as E,g as n,w as l,F as $,f as i,Z,z as q,h as v,t as C,k as w,l as G,m as J,j as x,n as K}from"./app-BxcjcWUP.js";import{H as Q}from"./Header-GYfsRgHP.js";import{_ as W}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./granny_logo-Bzff25CZ.js";import"./BackButton-CG7jGwel.js";const X={class:"content"},Y={class:"d-flex align-center w-100 mb-2 flex-row justify-center"},ee=["src"],te={class:"text-h5 mb-2 font-bold text-white"},ae={key:0},se={class:"img-border"},oe=["src"],ne={class:"font text-accent text-p"},le=Object.assign({layout:T},{__name:"SegmentationPage",props:{analysis_id:String},setup(R){const r=R,D=s(!1),S=s(!1),V=s(null);s("");const p=s(""),h=s({}),_=s([]),u=s([]),d=O({});s([]),s([]);const B=[{title:"Starch",value:"starch"},{title:"Superficial Scald",value:"scald"}];P(V,()=>{D.value=!1}),H(()=>{z(),L()});const L=async()=>{try{const t=await c.get(`/api/v1/getMaskedImage/${r.analysis_id}`,{responseType:"arraybuffer"}),e=new Blob([t.data]);h.value=URL.createObjectURL(e)}catch(t){console.log(t)}},U=async t=>{try{const e=await c.get(`/api/v1/getSegmentedImage/${r.analysis_id}/${t}`,{responseType:"arraybuffer"}),f=new Blob([e.data]);_.value.push(URL.createObjectURL(f))}catch(e){console.log(e)}},j=async t=>{try{const e=await c.get(`/api/v1/getSegmentedImageData/${r.analysis_id}/${t}`);u.value.push(e.data)}catch(e){console.log(e)}},F=async t=>{try{const e=await c.get(`/api/v1/getSegmentedImageData/${r.analysis_id}/${t}`);u.value[t-1]=e.data}catch(e){console.log(e)}},k=async t=>{try{const e=await c.put(`/api/v1/flagSegmentedImage/${r.analysis_id}/${t}`);console.log(e),F(t)}catch(e){console.log(e)}},z=async()=>{try{const t=await c.get(`/api/v1/getAnalysis/${r.analysis_id}`);d.value=t.data,_.value=[],u.value=[];for(let e=1;e<=d.value.segmented_image_count;e++)j(e),U(e)}catch(t){console.log(t)}},A=async()=>{S.value=!0;try{const t=await c.put(`/api/v1/fruitRating/${r.analysis_id}/${p.value}`);console.log(t.data),J.visit("/fruit-rating/"+d.value.id,{method:"get"})}catch(t){console.log(t)}};return(t,e)=>{const f=m("v-list-item"),M=m("v-select"),y=m("v-btn"),g=m("v-card");return i(),b($,null,[o(E(Z),{title:"Segmentation"}),o(Q,{title:"Segmentation",drawer:!0}),n("div",X,[o(g,{class:"card1"},{default:l(()=>[e[3]||(e[3]=n("div",{class:"text-h5 mb-2 font-bold text-white"},"Segmentation",-1)),o(g,{class:"inner-card",color:"white"},{default:l(()=>[n("div",Y,[n("img",{src:h.value,alt:"",class:"image"},null,8,ee)]),n("div",null,[o(M,{class:"font text-accent",modelValue:p.value,"onUpdate:modelValue":e[0]||(e[0]=a=>p.value=a),items:B,"item-title":"title","item-value":"value",label:"Select Rating Module",variant:"underlined",color:"accent"},{item:l(({props:a,item:I})=>[o(f,q({class:"text-accent font"},a),null,16)]),_:1},8,["modelValue"]),o(y,{color:"secondary",block:"",class:"font text-accent",loading:S.value,onClick:e[1]||(e[1]=a=>A())},{default:l(()=>e[2]||(e[2]=[v("Submit for Fruit Rating")])),_:1},8,["loading"])])]),_:1})]),_:1}),o(g,{class:"card2"},{default:l(()=>[n("div",te,[e[4]||(e[4]=v(" Review Images ")),d.value?(i(),b("span",ae,"("+C(d.value.segmented_image_count)+")",1)):w("",!0)]),o(g,{class:"segments-card",color:"white"},{default:l(()=>[(i(!0),b($,null,G(u.value,(a,I)=>(i(),x(g,{color:"secondary",class:"segment-outer-card"},{default:l(()=>[n("div",se,[n("img",{class:K(a.flagged?"flagged-img":"result-img"),src:_.value[I],alt:""},null,10,oe)]),n("div",ne," Fruit "+C(a.segment_number),1),a.flagged?w("",!0):(i(),x(y,{key:0,size:"x-small",color:"error",onClick:N=>k(a.segment_number)},{default:l(()=>e[5]||(e[5]=[v("Ignore")])),_:2},1032,["onClick"])),a.flagged?(i(),x(y,{key:1,size:"x-small",color:"warning","prepend-icon":"mdi-undo",onClick:N=>k(a.segment_number)},{default:l(()=>e[6]||(e[6]=[v("Undo")])),_:2},1032,["onClick"])):w("",!0)]),_:2},1024))),256))]),_:1})]),_:1})])],64)}}}),me=W(le,[["__scopeId","data-v-eec2dc93"]]);export{me as default};
