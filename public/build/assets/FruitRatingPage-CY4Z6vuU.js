import{P as H,s as fe,a as ye,b as be}from"./papaparse.min-DsQQ9vbY.js";import{A as xe}from"./AuthenticatedLayout-Csk7A1cc.js";import{r as o,y as E,o as we,b as i,c as r,d as s,u as M,w as t,F as f,e as _,f as n,Z as ke,g as c,l as b,h as p,i as he,j as x,t as m,k as C,z as Se}from"./app-BxcjcWUP.js";import{H as Ie}from"./Header-GYfsRgHP.js";import{_ as Re}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./granny_logo-Bzff25CZ.js";import"./BackButton-CG7jGwel.js";const Le={class:"content"},Oe={class:"d-flex flex-column"},Ae={class:"font text-accent w-50"},Ce={class:"font text-accent"},Ne={key:0,class:"font text-accent w-50"},Ve={key:1,class:"font text-accent w-50"},De={class:"ratings"},$e={key:0,class:"font text-accent w-50"},Te={key:1,class:"font text-accent w-50"},Ue={class:"font text-accent w-50"},Ee={key:0,class:"font text-accent w-50"},Be={key:1,class:"font text-accent"},je={class:"d-flex justify-between"},Fe={class:"d-flex w-100 align-center justify-between"},Ge=["src"],He={class:"font text-accent"},Me=["src"],Pe={class:"text-p font text-accent"},We=["src"],ze=["src"],Ye={__name:"FruitRatingPage",props:{analysis_id:String},setup(P){const v=P;o(null);const I=o(!1);o(!1);const B=o(""),w=o({key:"",value:""}),N=o([]),k=o({}),j=o({}),F=o({}),R=o(null);o([]);const V=o([]),D=o([]),$=o([]),h=o([]),T=o([]),W=o(["Name","HONEY_CRISP","WA38_1","WA38_2","ALLAN_BROS","GOLDEN_DELICIOUS","GRANNY_SMITH","JONAGOLD","CORNELL","rating","TrayName"]),z=o([{key:"Avg. Rating",value:"rating"},{key:"Honey Crisp",value:"HONEY_CRISP"},{key:"WA-38 V1",value:"WA38_1"},{key:"WA-38 V2",value:"WA38_2"},{key:"Allan Brothers",value:"ALLAN_BROS"},{key:"Golden Delicious",value:"GOLDEN_DELICIOUS"},{key:"Granny Smith",value:"GRANNY_SMITH"},{key:"Jonagold",value:"JONAGOLD"},{key:"Cornel",value:"CORNELL"}]);var y=o([]);const G=o(),Y=()=>{G.value.exportCSV()},S=o(!1),J=async()=>{try{const a=await _.get(`/api/v1/getResults/${v.analysis_id}`,{responseType:"text"});B.value=H.parse(a.data,{skipEmptyLines:!0,header:!0})}catch(a){console.error(a)}},Z=async()=>{try{const a=await _.get(`/api/v1/getTraySummary/${v.analysis_id}`,{responseType:"text"});H.parse(a.data,{skipEmptyLines:!0,header:!0}).data.forEach(e=>{Object.entries(e).forEach(([u,U])=>{N.value.push({key:u,value:U})})})}catch(a){console.error(a)}},q=async()=>{try{const a=await _.get(`/api/v1/getOriginalImage/${v.analysis_id}`,{responseType:"arraybuffer"}),e=new Blob([a.data]);F.value=URL.createObjectURL(e)}catch(a){console.log(a)}},K=async()=>{try{const a=await _.get(`/api/v1/getMaskedImage/${v.analysis_id}`,{responseType:"arraybuffer"}),e=new Blob([a.data]);j.value=URL.createObjectURL(e)}catch(a){console.log(a)}},Q=async a=>{try{const e=await _.get(`/api/v1/getRatingImage/${v.analysis_id}/${a}`,{responseType:"arraybuffer"}),u=new Blob([e.data]);V.value.push(URL.createObjectURL(u))}catch(e){console.log(e)}},X=async a=>{try{const e=await _.get(`/api/v1/getSegmentedImageData/${v.analysis_id}/${a}`);D.value.push(e.data)}catch(e){console.log(e)}},ee=async()=>{try{const a=await _.get(`/api/v1/getAnalysis/${v.analysis_id}`);k.value=a.data,V.value=[],D.value=[],$.value=[],T.value=[],y.value.push({name:"Submitted By",value:k.value.user_name}),y.value.push({name:"Time Started",value:k.value.time}),y.value.push({name:"Original Image",value:k.value.original_image}),y.value.push({name:"Segmentation Model",value:k.value.a1_model}),y.value.push({name:"Analysis Type",value:k.value.a2_type});for(let e=0;e<h.value.length;e++)await X(h.value[e].segment_number),await Q(h.value[e].segment_number),await le(h.value[e].segment_number),await se(h.value[e].segment_number)}catch(a){console.log(a)}},te=E(()=>y.value.slice(1,2));E(()=>y.value.slice(0,2));const ae=E(()=>y.value.slice(2)),se=async a=>{try{const e=await _.get(`/api/v1/getSegmentedImage/${v.analysis_id}/${a}`,{responseType:"arraybuffer"}),u=new Blob([e.data]);$.value.push(URL.createObjectURL(u))}catch(e){console.log(e)}},le=async a=>{try{const e=await _.get(`/api/v1/getSegmentedImageData/${v.analysis_id}/${a}`);T.value.push(e.data)}catch(e){console.log(e)}},ne=async()=>{try{const a=await _.get(`/api/v1/getSegmentedImages/${v.analysis_id}`);h.value=a.data}catch(a){console.log(a)}},oe=a=>a&&a.charAt(0).toUpperCase()+a.slice(1);return we(()=>{ne(),ee(),K(),q(),J(),Z(),w.value.key="Avg. Rating",w.value.value="rating"}),(a,e)=>{const u=i("v-btn"),U=i("v-list-item-title"),re=i("v-list-item"),ce=i("v-list"),ue=i("v-menu"),ie=i("v-table"),de=be,me=fe,ve=ye,g=i("v-card"),L=i("v-tab"),ge=i("v-tabs"),O=i("v-container"),A=i("v-tabs-window-item"),_e=i("v-tabs-window");return n(),r(f,null,[s(M(ke),{title:"Fruit Rating"}),s(xe,null,{default:t(()=>[s(Ie,{title:"Fruit Rating",drawer:!0}),c("div",Le,[s(g,{class:"d-flex flex-column card1 justify-between",color:"accent"},{default:t(()=>[e[13]||(e[13]=c("div",{class:"text-h5 font-bold text-white"},"Data Summary",-1)),s(g,{class:"inner-card d-flex flex-column justify-between"},{default:t(()=>[c("div",Oe,[s(ie,null,{default:t(()=>[c("tbody",null,[(n(!0),r(f,null,b(te.value,l=>(n(),r("tr",null,[c("td",Ae,m(l.name),1),c("td",Ce,m(l.value),1)]))),256)),(n(!0),r(f,null,b(N.value,l=>(n(),r("tr",null,[l.key=="TrayName"?(n(),r("td",Ne," Tray Name ")):C("",!0),l.key=="TrayName"?(n(),r("td",Ve,m(l.value),1)):C("",!0)]))),256)),(n(!0),r(f,null,b(N.value,l=>(n(),r("tr",De,[l.key==w.value.value?(n(),r("td",$e,[s(ue,{modelValue:I.value,"onUpdate:modelValue":e[0]||(e[0]=d=>I.value=d)},{activator:t(({props:d})=>[s(u,Se({size:"small",variant:"text",class:"font text-accent text-capitalize mx-0 px-0",color:"white",ref_for:!0},d,{"append-icon":I.value?"mdi-chevron-up":"mdi-chevron-down"}),{default:t(()=>[p(m(w.value.key),1)]),_:2},1040,["append-icon"])]),default:t(()=>[s(ce,null,{default:t(()=>[(n(!0),r(f,null,b(z.value,(d,pe)=>(n(),x(re,{key:pe,value:d,onClick:Je=>{w.value=d,I.value=!1}},{default:t(()=>[s(U,{class:"font text-accent"},{default:t(()=>[p(m(d.key),1)]),_:2},1024)]),_:2},1032,["value","onClick"]))),128))]),_:1})]),_:1},8,["modelValue"])])):C("",!0),l.key==w.value.value?(n(),r("td",Te,m(l.value),1)):C("",!0)]))),256)),(n(!0),r(f,null,b(ae.value,l=>(n(),r("tr",null,[c("td",Ue,m(l.name),1),l.name==="Analysis Type"?(n(),r("td",Ee,m(oe(l.value)),1)):(n(),r("td",Be,m(l.value),1))]))),256))])]),_:1})]),c("div",je,[s(u,{class:"text-accent font",color:"secondary","prepend-icon":"mdi-file",onClick:e[1]||(e[1]=l=>S.value=!0)},{default:t(()=>e[8]||(e[8]=[p("View Results CSV")])),_:1}),s(M(he),{href:a.route("apples")},{default:t(()=>[s(u,{class:"text-accent font",color:"secondary"},{default:t(()=>e[9]||(e[9]=[p("Done")])),_:1})]),_:1},8,["href"]),s(ve,{visible:S.value,"onUpdate:visible":e[5]||(e[5]=l=>S.value=l),class:"text-h5 bg-accent font-bold text-white",header:"Results",style:{width:"90vw"},modal:"",closable:!1,contentStyle:{height:"500px"}},{header:t(()=>[c("div",Fe,[e[10]||(e[10]=c("div",{class:"text-h5 font-bold text-white"}," Results ",-1)),s(u,{color:"secondary",variant:"tonal",icon:"mdi-close",onClick:e[2]||(e[2]=l=>S.value=!1)})])]),footer:t(()=>[s(u,{class:"text-accent font",color:"secondary","prepend-icon":"mdi-export",onClick:e[3]||(e[3]=l=>Y(l))},{default:t(()=>e[11]||(e[11]=[p("Export")])),_:1}),s(u,{class:"text-accent font",color:"secondary","prepend-icon":"mdi-check",onClick:e[4]||(e[4]=l=>S.value=!1)},{default:t(()=>e[12]||(e[12]=[p("Done")])),_:1})]),default:t(()=>[s(me,{ref_key:"dt",ref:G,scrollable:"",sortField:"Name",sortOrder:1,scrollHeight:"flex",value:B.value.data,showGridlines:"",size:"small",stripedRows:"",class:"bg-white"},{default:t(()=>[(n(!0),r(f,null,b(W.value,l=>(n(),x(de,{class:"text-accent font",sortable:"",field:l,header:l},null,8,["field","header"]))),256))]),_:1},8,["value"])]),_:1},8,["visible"])])]),_:1})]),_:1}),s(g,{class:"card2",color:"accent"},{default:t(()=>[e[18]||(e[18]=c("div",{class:"text-h5 card-title font-bold text-white"}," Image Summary ",-1)),s(g,{color:"white",class:"inner-card d-flex flex-column justify-between"},{default:t(()=>[s(ge,{modelValue:R.value,"onUpdate:modelValue":e[6]||(e[6]=l=>R.value=l),"align-tabs":"center",class:"tabs","slider-color":"secondary"},{default:t(()=>[s(L,{class:"font text-accent",value:1},{default:t(()=>e[14]||(e[14]=[p("Rating")])),_:1}),s(L,{class:"font text-accent",value:2},{default:t(()=>e[15]||(e[15]=[p("Segmentation")])),_:1}),s(L,{class:"font text-accent",value:3},{default:t(()=>e[16]||(e[16]=[p("Masked")])),_:1}),s(L,{class:"font text-accent",value:4},{default:t(()=>e[17]||(e[17]=[p("Original")])),_:1})]),_:1},8,["modelValue"]),s(_e,{class:"pa-0 ma-0",modelValue:R.value,"onUpdate:modelValue":e[7]||(e[7]=l=>R.value=l)},{default:t(()=>[(n(),x(A,{class:"pa-0 ma-0",key:1,value:1},{default:t(()=>[s(O,{class:"pa-0 ma-0 container",fluid:""},{default:t(()=>[s(g,{class:"segments-card"},{default:t(()=>[(n(!0),r(f,null,b(D.value,(l,d)=>(n(),x(g,{class:"segment-outer-card",color:"white"},{default:t(()=>[c("img",{class:"result-img",src:V.value[d],alt:""},null,8,Ge),c("div",He," Fruit "+m(l.segment_number),1)]),_:2},1024))),256))]),_:1})]),_:1})]),_:1})),(n(),x(A,{key:2,value:2},{default:t(()=>[s(O,{class:"pa-0 ma-0",fluid:""},{default:t(()=>[s(g,{class:"segments-card"},{default:t(()=>[(n(!0),r(f,null,b(T.value,(l,d)=>(n(),x(g,{class:"segment-outer-card",color:"white"},{default:t(()=>[c("img",{class:"result-img",src:$.value[d],alt:""},null,8,Me),c("div",Pe," Fruit "+m(l.segment_number),1)]),_:2},1024))),256))]),_:1})]),_:1})]),_:1})),(n(),x(A,{key:3,value:3},{default:t(()=>[s(O,{class:"pa-0 ma-0",fluid:""},{default:t(()=>[s(g,{class:"segments-card"},{default:t(()=>[c("img",{class:"image",src:j.value,alt:""},null,8,We)]),_:1})]),_:1})]),_:1})),(n(),x(A,{key:4,value:4},{default:t(()=>[s(O,{class:"pa-0 ma-0",fluid:""},{default:t(()=>[s(g,{class:"segments-card"},{default:t(()=>[c("img",{class:"image",src:F.value,alt:""},null,8,ze)]),_:1})]),_:1})]),_:1}))]),_:1},8,["modelValue"])]),_:1})]),_:1})])]),_:1})],64)}}},at=Re(Ye,[["__scopeId","data-v-e53475a4"]]);export{at as default};
