import{P as H,s as pe,a as ye,b as be}from"./papaparse.min-DsQQ9vbY.js";import{A as xe}from"./AuthenticatedLayout-Csk7A1cc.js";import{r as o,y as M,o as we,b as i,c as r,d as s,u as P,w as t,F as p,e as g,f as n,Z as ke,g as c,l as y,h as f,i as he,j as b,t as m,k as C,z as Se}from"./app-BxcjcWUP.js";import{H as Ie}from"./Header-GYfsRgHP.js";import{_ as Re}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./granny_logo-Bzff25CZ.js";import"./BackButton-CG7jGwel.js";const Le={class:"content"},Oe={class:"d-flex flex-column"},Ae={class:"font text-accent w-50"},Ce={class:"font text-accent"},Ne={key:0,class:"font text-accent w-50"},Ve={key:1,class:"font text-accent w-50"},De={class:"ratings"},$e={key:0,class:"font text-accent w-50"},Te={key:1,class:"font text-accent w-50"},Ue={class:"font text-accent w-50"},Ee={key:0,class:"font text-accent w-50"},Be={key:1,class:"font text-accent"},je={class:"d-flex justify-between"},Ge={class:"d-flex w-100 align-center justify-between"},He=["src"],Me={class:"font text-accent"},Pe=["src"],Fe={class:"text-p font text-accent"},We=["src"],ze=["src"],Ye={__name:"SummaryPage",props:{analysis_id:String},setup(F){const v=F;o(null);const I=o(!1);o(!1);const E=o(""),k=o({key:"",value:""}),N=o([]),x=o({}),B=o({}),j=o({}),R=o(null);o([]);const V=o([]),D=o([]),$=o([]),h=o([]),T=o([]),W=o(["Name","HONEY_CRISP","WA38_1","WA38_2","ALLAN_BROS","GOLDEN_DELICIOUS","GRANNY_SMITH","JONAGOLD","CORNELL","rating","TrayName"]),z=o([{key:"Avg. Rating",value:"rating"},{key:"Honey Crisp",value:"HONEY_CRISP"},{key:"WA-38 V1",value:"WA38_1"},{key:"WA-38 V2",value:"WA38_2"},{key:"Allan Brothers",value:"ALLAN_BROS"},{key:"Golden Delicious",value:"GOLDEN_DELICIOUS"},{key:"Granny Smith",value:"GRANNY_SMITH"},{key:"Jonagold",value:"JONAGOLD"},{key:"Cornel",value:"CORNELL"}]);var w=o([]);const G=o(),Y=()=>{G.value.exportCSV()},S=o(!1),J=async()=>{try{const a=await g.get(`/api/v1/getResults/${v.analysis_id}`,{responseType:"text"});E.value=H.parse(a.data,{skipEmptyLines:!0,header:!0})}catch(a){console.error(a)}},Z=async()=>{try{const a=await g.get(`/api/v1/getTraySummary/${v.analysis_id}`,{responseType:"text"});H.parse(a.data,{skipEmptyLines:!0,header:!0}).data.forEach(e=>{Object.entries(e).forEach(([u,U])=>{N.value.push({key:u,value:U})})})}catch(a){console.error(a)}},q=async()=>{try{const a=await g.get(`/api/v1/getOriginalImage/${v.analysis_id}`,{responseType:"arraybuffer"}),e=new Blob([a.data]);j.value=URL.createObjectURL(e)}catch(a){console.log(a)}},K=async()=>{try{const a=await g.get(`/api/v1/getMaskedImage/${v.analysis_id}`,{responseType:"arraybuffer"}),e=new Blob([a.data]);B.value=URL.createObjectURL(e)}catch(a){console.log(a)}},Q=async a=>{try{const e=await g.get(`/api/v1/getRatingImage/${v.analysis_id}/${a}`,{responseType:"arraybuffer"}),u=new Blob([e.data]);V.value.push(URL.createObjectURL(u))}catch(e){console.log(e)}},X=async a=>{try{const e=await g.get(`/api/v1/getSegmentedImageData/${v.analysis_id}/${a}`);D.value.push(e.data)}catch(e){console.log(e)}},ee=async()=>{try{const a=await g.get(`/api/v1/getAnalysis/${v.analysis_id}`);x.value=a.data,V.value=[],D.value=[],$.value=[],T.value=[],w.value.push({name:"Submitted By",value:x.value.user_name}),w.value.push({name:"Date - Time",value:x.value.date+" - "+x.value.time}),w.value.push({name:"Original Image",value:x.value.original_image}),w.value.push({name:"Segmentation Model",value:x.value.a1_model}),w.value.push({name:"Analysis Type",value:x.value.a2_type});for(let e=0;e<h.value.length;e++)await X(h.value[e].segment_number),await Q(h.value[e].segment_number),await le(h.value[e].segment_number),await se(h.value[e].segment_number)}catch(a){console.log(a)}},te=M(()=>w.value.slice(0,2)),ae=M(()=>w.value.slice(2)),se=async a=>{try{const e=await g.get(`/api/v1/getSegmentedImage/${v.analysis_id}/${a}`,{responseType:"arraybuffer"}),u=new Blob([e.data]);$.value.push(URL.createObjectURL(u))}catch(e){console.log(e)}},le=async a=>{try{const e=await g.get(`/api/v1/getSegmentedImageData/${v.analysis_id}/${a}`);T.value.push(e.data)}catch(e){console.log(e)}},ne=async()=>{try{const a=await g.get(`/api/v1/getSegmentedImages/${v.analysis_id}`);h.value=a.data}catch(a){console.log(a)}},oe=a=>a&&a.charAt(0).toUpperCase()+a.slice(1);return we(()=>{ne(),ee(),K(),q(),J(),Z(),k.value.key="Avg. Rating",k.value.value="rating"}),(a,e)=>{const u=i("v-btn"),U=i("v-list-item-title"),re=i("v-list-item"),ce=i("v-list"),ue=i("v-menu"),ie=i("v-table"),de=be,me=pe,ve=ye,_=i("v-card"),L=i("v-tab"),_e=i("v-tabs"),O=i("v-container"),A=i("v-tabs-window-item"),ge=i("v-tabs-window");return n(),r(p,null,[s(P(ke),{title:"Summary"}),s(xe,null,{default:t(()=>[s(Ie,{title:"Summary",location:"dashboard"}),c("div",Le,[s(_,{class:"d-flex flex-column card1 justify-between",color:"accent"},{default:t(()=>[e[13]||(e[13]=c("div",{class:"text-h5 font-bold text-white"},"Data Summary",-1)),s(_,{class:"inner-card d-flex flex-column justify-between"},{default:t(()=>[c("div",Oe,[s(ie,null,{default:t(()=>[c("tbody",null,[(n(!0),r(p,null,y(te.value,l=>(n(),r("tr",null,[c("td",Ae,m(l.name),1),c("td",Ce,m(l.value),1)]))),256)),(n(!0),r(p,null,y(N.value,l=>(n(),r("tr",null,[l.key=="TrayName"?(n(),r("td",Ne," Tray Name ")):C("",!0),l.key=="TrayName"?(n(),r("td",Ve,m(l.value),1)):C("",!0)]))),256)),(n(!0),r(p,null,y(N.value,l=>(n(),r("tr",De,[l.key==k.value.value?(n(),r("td",$e,[s(ue,{modelValue:I.value,"onUpdate:modelValue":e[0]||(e[0]=d=>I.value=d)},{activator:t(({props:d})=>[s(u,Se({size:"small",variant:"text",class:"font text-accent text-capitalize mx-0 px-0",color:"white",ref_for:!0},d,{"append-icon":I.value?"mdi-chevron-up":"mdi-chevron-down"}),{default:t(()=>[f(m(k.value.key),1)]),_:2},1040,["append-icon"])]),default:t(()=>[s(ce,null,{default:t(()=>[(n(!0),r(p,null,y(z.value,(d,fe)=>(n(),b(re,{key:fe,value:d,onClick:Je=>{k.value=d,I.value=!1}},{default:t(()=>[s(U,{class:"font text-accent"},{default:t(()=>[f(m(d.key),1)]),_:2},1024)]),_:2},1032,["value","onClick"]))),128))]),_:1})]),_:1},8,["modelValue"])])):C("",!0),l.key==k.value.value?(n(),r("td",Te,m(l.value),1)):C("",!0)]))),256)),(n(!0),r(p,null,y(ae.value,l=>(n(),r("tr",null,[c("td",Ue,m(l.name),1),l.name==="Analysis Type"?(n(),r("td",Ee,m(oe(l.value)),1)):(n(),r("td",Be,m(l.value),1))]))),256))])]),_:1})]),c("div",je,[s(u,{class:"text-accent font",color:"secondary","prepend-icon":"mdi-file",onClick:e[1]||(e[1]=l=>S.value=!0)},{default:t(()=>e[8]||(e[8]=[f("View Results CSV")])),_:1}),s(P(he),{href:a.route("apples")},{default:t(()=>[s(u,{class:"text-accent font",color:"secondary"},{default:t(()=>e[9]||(e[9]=[f("Done")])),_:1})]),_:1},8,["href"]),s(ve,{visible:S.value,"onUpdate:visible":e[5]||(e[5]=l=>S.value=l),class:"text-h5 bg-accent font-bold text-white",header:"Results",style:{width:"90vw"},modal:"",closable:!1,contentStyle:{height:"500px"}},{header:t(()=>[c("div",Ge,[e[10]||(e[10]=c("div",{class:"text-h5 font-bold text-white"}," Results ",-1)),s(u,{color:"secondary",variant:"tonal",icon:"mdi-close",onClick:e[2]||(e[2]=l=>S.value=!1)})])]),footer:t(()=>[s(u,{class:"text-accent font",color:"secondary","prepend-icon":"mdi-export",onClick:e[3]||(e[3]=l=>Y(l))},{default:t(()=>e[11]||(e[11]=[f("Export")])),_:1}),s(u,{class:"text-accent font",color:"secondary","prepend-icon":"mdi-check",onClick:e[4]||(e[4]=l=>S.value=!1)},{default:t(()=>e[12]||(e[12]=[f("Done")])),_:1})]),default:t(()=>[s(me,{ref_key:"dt",ref:G,scrollable:"",sortField:"Name",sortOrder:1,scrollHeight:"flex",value:E.value.data,showGridlines:"",size:"small",stripedRows:"",class:"bg-white"},{default:t(()=>[(n(!0),r(p,null,y(W.value,l=>(n(),b(de,{class:"text-accent font",sortable:"",field:l,header:l},null,8,["field","header"]))),256))]),_:1},8,["value"])]),_:1},8,["visible"])])]),_:1})]),_:1}),s(_,{class:"card2",color:"accent"},{default:t(()=>[e[18]||(e[18]=c("div",{class:"text-h5 card-title font-bold text-white"}," Image Summary ",-1)),s(_,{color:"white",class:"inner-card d-flex flex-column justify-between"},{default:t(()=>[s(_e,{modelValue:R.value,"onUpdate:modelValue":e[6]||(e[6]=l=>R.value=l),"align-tabs":"center",class:"tabs","slider-color":"secondary"},{default:t(()=>[s(L,{class:"font text-accent",value:1},{default:t(()=>e[14]||(e[14]=[f("Rating")])),_:1}),s(L,{class:"font text-accent",value:2},{default:t(()=>e[15]||(e[15]=[f("Segmentation")])),_:1}),s(L,{class:"font text-accent",value:3},{default:t(()=>e[16]||(e[16]=[f("Masked")])),_:1}),s(L,{class:"font text-accent",value:4},{default:t(()=>e[17]||(e[17]=[f("Original")])),_:1})]),_:1},8,["modelValue"]),s(ge,{class:"pa-0 ma-0",modelValue:R.value,"onUpdate:modelValue":e[7]||(e[7]=l=>R.value=l)},{default:t(()=>[(n(),b(A,{class:"pa-0 ma-0",key:1,value:1},{default:t(()=>[s(O,{class:"pa-0 ma-0 container",fluid:""},{default:t(()=>[s(_,{class:"segments-card"},{default:t(()=>[(n(!0),r(p,null,y(D.value,(l,d)=>(n(),b(_,{class:"segment-outer-card",color:"white"},{default:t(()=>[c("img",{class:"result-img",src:V.value[d],alt:""},null,8,He),c("div",Me," Fruit "+m(l.segment_number),1)]),_:2},1024))),256))]),_:1})]),_:1})]),_:1})),(n(),b(A,{key:2,value:2},{default:t(()=>[s(O,{class:"pa-0 ma-0",fluid:""},{default:t(()=>[s(_,{class:"segments-card"},{default:t(()=>[(n(!0),r(p,null,y(T.value,(l,d)=>(n(),b(_,{class:"segment-outer-card",color:"white"},{default:t(()=>[c("img",{class:"result-img",src:$.value[d],alt:""},null,8,Pe),c("div",Fe," Fruit "+m(l.segment_number),1)]),_:2},1024))),256))]),_:1})]),_:1})]),_:1})),(n(),b(A,{key:3,value:3},{default:t(()=>[s(O,{class:"pa-0 ma-0",fluid:""},{default:t(()=>[s(_,{class:"segments-card"},{default:t(()=>[c("img",{class:"image",src:B.value,alt:""},null,8,We)]),_:1})]),_:1})]),_:1})),(n(),b(A,{key:4,value:4},{default:t(()=>[s(O,{class:"pa-0 ma-0",fluid:""},{default:t(()=>[s(_,{class:"segments-card"},{default:t(()=>[c("img",{class:"image",src:j.value,alt:""},null,8,ze)]),_:1})]),_:1})]),_:1}))]),_:1},8,["modelValue"])]),_:1})]),_:1})])]),_:1})],64)}}},at=Re(Ye,[["__scopeId","data-v-93e5d10d"]]);export{at as default};
